#include <stdint.h>
#include "printf.h"
#include "tone.h"
#include "systick.h"
#include "adc.h"
#include "dac.h"
#include "tone.h"

static int count = 0;

void SysTick_Handler () {
    count++;
}

void Error_Handler(){
	//print error is you get em
}
//frequency is in hertz
void run_wave (uint32_t freq) {
    init_systick ();
    uint32_t duration = hertz_to_duration (freq);
    DAC_Init ();
    ADC_Init ();

    DAC_Start ();
    //replace prints with actual power settings
    //runat a ressonable frequency
    while (1) {
        if (count % duration < (duration >> 1)) {
        	ADC_Start ();
        	DAC_Set_Value (2000);
        }else{
        	DAC_Set_Value(0);
        }
    }
}
